# ===================================================================
# PR Guardian AI - Environment Configuration Example
# ===================================================================
# Copy this file to `.env` and fill in the values before deploying.
#
# DEPLOYMENT TUTORIAL: Railway.com (with GitHub App)
# ===================================================================
#
# Quick Start Guide to Deploy PR Guardian AI on Railway:
#
# 1. Create GitHub App
#    ------------------------------------------
#    - Go to: https://github.com/settings/apps
#    - Click "New GitHub App"
#    - App name: PR Guardian AI
#    - Homepage URL: https://your-app.railway.app (set after deploying)
#    - Callback URL: https://your-app.railway.app/auth/callback
#    - Webhook URL: https://your-app.railway.app/webhook
#    - Webhook secret: Generate a random secret (save it!)
#    - Permissions:
#      ✓ Pull requests: Read & Write
#      ✓ Contents: Read
#      ✓ Metadata: Read
#      ✓ Checks: Read (optional)
#    - Events: Pull requests, Installation
#    - Click "Create GitHub App"
#    - Generate and download the private key (save the .pem file content)
#
# 2. Get OpenAI API Key
#    -------------------
#    - Go to: https://platform.openai.com/api-keys
#    - Click "Create new secret key"
#    - Name it: "PR Guardian AI"
#    - Copy the key
#
# 3. Deploy on Railway
#    ------------------
#    a) Go to: https://railway.app/
#    b) Click "New Project" -> "Deploy from GitHub repo"
#    c) Select this repository
#    d) Railway will detect it's a Python project automatically
#    e) Add PostgreSQL plugin (click "New Service" -> "Add Database")
#    f) Copy your Railway DATABASE_URL from the database service
#    g) Click "Deploy"
#
# 4. Add Environment Variables in Railway
#    ------------------------------------
#    In your Railway project, go to the "Variables" tab and add:
#
#    ========== REQUIRED ==========
#    OPENAI_API_KEY=sk-your-openai-key-here
#    DATABASE_URL=postgresql://...(provided by Railway)
#    SECRET_KEY=generate-a-random-secret-key
#    APP_URL=https://your-app.railway.app
#
#    ========== GITHUB APP ==========
#    GITHUB_APP_ID=your-github-app-id
#    GITHUB_APP_CLIENT_ID=your-github-app-client-id
#    GITHUB_APP_CLIENT_SECRET=your-github-app-client-secret
#    GITHUB_APP_WEBHOOK_SECRET=your-webhook-secret
#    GITHUB_APP_PRIVATE_KEY="-----BEGIN RSA PRIVATE KEY-----
#    MIIEpAIBAAKCAQEA...(paste the content of your .pem file)
#    -----END RSA PRIVATE KEY-----"
#
#    ========== OPTIONAL ==========
#    OPENAI_BASE_URL=https://api.openai.com/v1
#    OPENAI_MODEL_ID=gpt-4o-mini
#    BOT_NAME=PR Guardian AI
#    LOG_LEVEL=info
#
#    c) Click "Add Variable" after each one
#    d) Click "Save Changes" and Railway will restart your app
#
# 5. Initialize Database
#    ----------------------
#    After deployment, run the following in Railway console:
#    alembic upgrade head
#
#    Or add a startup script to auto-migrate
#
# 6. Test the Setup
#    --------------
#    - Open your app URL: https://your-app.railway.app
#    - Click "Sign in with GitHub"
#    - Authorize the GitHub App
#    - Select repositories to monitor
#    - Create a test pull request
#    - Bot should post a comment within seconds
#
# ===================================================================
# Troubleshooting
# ===================================================================
#
# Problem: "Failed to fetch PR diff"
# Solution: Check GitHub App has correct permissions
#
# Problem: "Failed to generate AI review"
# Solution: Check OPENAI_API_KEY is valid and has credits
#
# Problem: Webhook not triggering
# Solution: Check GitHub App webhook URL is correct
#
# Problem: "Not authenticated"
# Solution: Complete the OAuth flow with GitHub
#
# ===================================================================

# ================== REQUIRED SETTINGS ==================

# OpenAI API Key
# Create at: https://platform.openai.com/api-keys
OPENAI_API_KEY=sk-your-openai-api-key-here

# Database URL (PostgreSQL provided by Railway)
# Example: postgresql://postgres:password@hostname:5432/dbname
DATABASE_URL=postgresql://user:pass@localhost/prguardian

# Application URL (your deployed app URL)
APP_URL=http://localhost:8000

# Secret Key for JWT and encryption (generate a secure random key)
SECRET_KEY=change-this-to-a-secure-random-key-in-production

# ================== GITHUB APP SETTINGS ==================

# GitHub App ID (from GitHub App settings)
GITHUB_APP_ID=

# GitHub App Client ID (from GitHub App settings)
GITHUB_APP_CLIENT_ID=

# GitHub App Client Secret (from GitHub App settings)
GITHUB_APP_CLIENT_SECRET=

# GitHub App Webhook Secret (from GitHub App settings)
GITHUB_APP_WEBHOOK_SECRET=

# GitHub App Private Key (content of .pem file)
# Use the format below - paste the entire PEM file content including the BEGIN/END lines
GITHUB_APP_PRIVATE_KEY="-----BEGIN RSA PRIVATE KEY-----
MIIEpAIBAAKCAQEA...
(paste your private key content here)
...
-----END RSA PRIVATE KEY-----"

# ================== LEGACY SETTINGS (OPTIONAL) ==================

# GitHub Personal Access Token (for backward compatibility)
# Not needed when using GitHub App
GITHUB_TOKEN=

# GitHub Webhook Secret (for signature verification, optional)
GITHUB_WEBHOOK_SECRET=

# ================== OPENAI SETTINGS ==================

# OpenAI Base URL (default: official OpenAI API)
OPENAI_BASE_URL=https://api.openai.com/v1

# OpenAI Model ID (default: gpt-4o-mini)
OPENAI_MODEL_ID=gpt-4o-mini

# Bot Display Name (used in comments)
BOT_NAME=PR Guardian AI

# Logging Level: debug, info, warning, error
LOG_LEVEL=info

